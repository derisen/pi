{% extends 'base.html.twig' %}

{% block pageheader %} 
    <h1>Video</h1>
{% endblock %} 

{% block body %}

    <div class="btn-toolbar">
        <div class="btn-group pull-right">
            <a href="{{ path('video_refresh', {'id': video.id}) }}" class="btn btn-default">
                <span class="glyphicon glyphicon-refresh"></span> Refresh
            </a>
            <a href="{{ path('video_index') }}" class="btn btn-default">
                <span class="glyphicon glyphicon-arrow-left"></span> Back
            </a>
        </div>
    </div>

    <div class="clearfix"></div>

    <h2>{{ video }}</h2>

    <div class="row">
        {{ video.player|raw }}
    </div>


    <h3>Profile</h3>
    {{ form_start(form) }}
    {{ form_widget(form) }}
	<div class="form-group">
		<div class="col-sm-2"></div>
		<div class="col-sm-10">
			<input type="submit" value="Update" class="btn btn-primary" />
			<a href="{{ path('video_show', { 'id': video.id }) }}" class="btn btn-warning">Cancel</a>
		</div>
	</div>
    {{ form_end(form) }}

{% endblock %}

{% block styles %}
    <link href="{{ asset('bower/select2/dist/css/select2.min.css') }}" rel="stylesheet" />
    <link href="{{ asset('bower/select2-bootstrap-theme/dist/select2-bootstrap.min.css') }}" rel="stylesheet" />
{% endblock %}

{% block javascripts %}    
    <script src="{{ asset('bower/select2/dist/js/select2.min.js') }}"></script>
    
    <script type="text/javascript">
        var url = "{{ path('video_profile_selection', {'id': video.id}) }}";
    </script>
    
    <script type="text/javascript">
        $(document).ready(function () {
            $('select.selectable').select2({tags: true});
            $('select.selectable').on('select2:select', function (e) {
                var elementName = $(this).data('element-name');
                console.log(e.params.data);
                $.ajax({
                    cache: false,
                    error: function(jqXhr, status, error) {
                        console.log(status + ": " + error);
                    },
                    success: function(data, status, jqXhr){
                        console.log(data.message);
                    },
                    data: {
                        'name': elementName,
                        'data': {
                            text: e.params.data.text,
                            id: e.params.data.id,
                        },
                    },
                    url: url,
                });
            });
            $('select.selectable').on('select2:select', function(e){
                // ajax submit the tag
                // get the tag's id
                // find the tag's option element
                // set its id.
                console.log(e.params);
            });
        });
    </script>
    
{% endblock %}

